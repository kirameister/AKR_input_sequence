# 実際の配列を決めていく

さて、裏 AKR 配列に関する大まかな方向性が定まり、配列を決めるときの鍵となるような N-gram のデータも揃った。ようやく配列を決めていくことにする。

### 最も重要な３つの文字

uni-gram のデータを見ると、(新下駄配列でもそうであったように) `い`、`う`、`ん` の三文字が圧倒的に多く出現しているのが分かる (次は `し` だが、頻度で言えば `ん` の 7 割程度だ)。

ところで私は `ゃゅょ` という拗音文字の入力にそれぞれ `/ss/`、`/ll/`、`/l;/` を使おうと考えている。つまり `[き]ょう` や `[じ]ゅう` という文字列を打つ場合、アルペジオ的なことを考えると、`う` は右手側にある方が望ましいということになる。

これら３つの文字は、当然単打面の一番打ちやすい場所に配置されるが、bi-gram データを見ると、`うい` が `いう` よりも大分多く現れている。これって私の直感に大分反している気がする。bi-gram の元データを見ると「じゅういち」や「にじゅういち」というデータを見かける。なるほどこれらが合わさって `うい` に重みがついているのか。そして `い` から始まる bi-gram と `う` から始まるそれを比較すると、後者のほうが少しだけ頻繁にあるように見える。ここは私の個人的な直感を優先させて `いう` の方が優勢であるとして

* 確定: `/j/` => `う`
* 確定: `/k/` => `い`
* 確定: `/f/` => `ん`

とする (つまり新下駄配列と同じである)。

それから `ん` であるが、`/f/` ではなくて `/r/` でも良いのではないかと迷いはした (文頭や文節の最初には来ない文字のため)。しかし `ん` が中に来る単語も多いため (`かんがえ` や `さんじゅう` など)、`/f/` が良いだろうと判断した。

### bi-gram / tri-gram を使った考察

今の所確定しているのは `う`、`い`、`ん` の三文字しかないのだが、この辺で早速 tri-gram を見ていくことにする。これら三文字に関しては拗音文字が周りにあるパターンが多いのだけれど、それ以外にも `せ`、`じ`、`し` が近くにある。bi-gram の中身を見ると、`せ`、`こ`、`か`、`て` がある。まずは uni-gram でも順位の高い `し` と `か` を考える。

`しん` という流れは目立つがそれ以外は `[いうん]し` というパターンが多いように見える。一方 `か` に関してはこれら三文字の前にも後にも来るパターンが多いという印象。これらのことから

* 確定: `/d/` => `か`
* 確定: `/e/` => `し`

としていく。

次に `せ` について考えていく。`う|い` は既に右手単打面のホームポジションにあるため、間に入る `せ` も単打面が良いということになるが、`せ` は uni-gram 的には 30 番目にある文字である。これらのことから `せ` は「それだけだと打ちにくい位置だけど、`[うい]` との組み合わせとしては打ちやすい場所」に配置されるべきであろう(今のところの個人的な感覚は `/z/` か `/x/` か `/p/` なのだけれどまだ決定的ではない)。

* 未確定: `/[zxp]/` => `せ`

`の` もランクは高いのだけれど、新下駄配列 (とその考え方) に倣って `/a/` に置くことにする。

* 確定: `/a/` => `の`

現状決まったのは以下の通り:

```
__ __ し __ __      __ __ __ __ __
の シ か ん __      __ う い シ シ
__ __ __ __ __      __ __ __ __ __
```

`の` を無理やり決定してしまったので、ついでに `る` についても考える。周りに `。` が出てくる (ということは、文の最後に来やすい) 文字である。他にも `する` や `いる` `くる` があるが、`る` で始まる bi-gram はランクがあまり高くない (`ると` ぐらいかな)。外側から内側下部への流れを考えると、これは `/v/` が妥当だと考える。`。` だがこちらは `/./` が妥当だと考える。`[たるい]。` という流れがあるが、この位置なら流れを損なうことも無いだろうという考え。

* 確定: `/v/` => `る`
* 確定: `/./` => `。`

ちなみに `た` は uni-gram ランク 9 である。ここは `たい` のアルペジオを意識して `/o/` か `/n/` に配置するのが妥当だと考えるが、`。` のことも考えて `/n/` に配置する (`た。` はアルペジオで表現したい上にキーボードによっては `/m/` だと `/k/` とのアルペジオがタイトすぎることがある)。

* 確定: `/n/` => `た`

...この辺で一々自分の思考を文にするのが疲れてきた。上のようなことを考えながら、bi-gram と tri-gram の並びを見て、以下のように決定していく。

* `と` => ランク 7。`ん_と_う - い_と_う - と_い_う - う_と_う` の流れが上には入っている。本来ならば新下駄配列のように `/s/` に配置したいところだが、それはシフトキーなので `/w/` が妥当であると考える。
    * 確定: `/w/` => `と`
* `こ` => ランク 16。`ん_こ_う - う_こ_う - い_こ_う` の流れが上には入っている。4-gram を見てみると `(け|か|じ|し|さ|へ)_ん_こ_う` が上位にある。bi-gram では `こ_い` というのがあまり上位になかったので、`/i/` に配置。
    * 確定: `/i/` => `こ`
* `が` => ランク 18。`う_が_い - い_が_い` の流れが上には入っている。迷ったが N-gram を眺めながら `/o/` に配置する。
    * 確定: `/o/` => `が`
* `さ` => ランク 26。`う_さ_い - う_さ_ん` の流れが上には入っている。配置は後回し。
* `せ` => ランク 30。`ん_せ_い - う_せ_ん` の流れが上には入っている。`/z/` か `/x/` か `/e/` が候補だったが、`/e/` が `し` に割り当てられたことで `/x/` に決定。
    * 確定: `/x/` => `せ`
* `け` => ランク 37。`ん_け_い - い_け_ん` の流れが上には入っている。配置は後回し。


それから今まで個人的にタイプしてきて良いと思った (つまり個人的な好みの) 配置をしていく。

* 確定: `/q/` => `ー`
* 確定: `/g/` => `っ`

これまでの決めてきたこと (といってもまた後で覆るかも知れないけれど) をまとめると以下のようになるだろうか。

```
ー と し __ __      __ __ こ が __
の シ か ん っ      __ う い シ シ
__ せ __ __ __      た __ __ 。 __
```







